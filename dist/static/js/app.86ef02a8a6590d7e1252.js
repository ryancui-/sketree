webpackJsonp([1],{"0UbK":function(e,t){},C07W:function(e,t){},FlXh:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("7+uW"),r=n("efYS"),o=n.n(r),s=n("Dd8w"),a=n.n(s),c=n("NYxO"),l={name:"TreePad",data:function(){return{canvas:null,selectedNode:null}},mounted:function(){this.init()},computed:a()({},Object(c.c)(["nodes"])),methods:{init:function(){var e=this;this.canvas=new fabric.Canvas("pad"),this.canvas.setDimensions({width:700,height:700}),this.canvas.selection=!1,document.documentElement.addEventListener("keydown",function(t){!e.selectedNode||46!==t.keyCode&&8!==t.keyCode||e.removeTreeNode(e.selectedNode)}),this.addTreeNode(340,50)},addTreeNode:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=new fabric.Circle({radius:20,fill:i?"#fff":"#bbecff",left:e,top:t,hasControls:!1,hasRotatingPoint:!1,selectable:!!i,stroke:"#666",strokeWidth:5}),o=null;null!==i&&(o=new fabric.Line([r.getCenterPoint().x,r.getCenterPoint().y,i.circle.getCenterPoint().x,i.circle.getCenterPoint().y],{stroke:"#000",strokeWidth:3,selectable:!1,hoverCursor:"default"}),this.canvas.add(o),o.moveTo(i.circle.get("zIndex")-1)),r.on("selected",function(){n.selectedNode=r.get("node")}),r.on("deselected",function(){n.selectedNode=null}),r.on("moving",function(e){var t=e.target.get("node");null!==o&&o.set({x1:r.getCenterPoint().x,y1:r.getCenterPoint().y}),n.nodes.filter(function(e){return e.parent===t}).forEach(function(e){e.line.set({x2:r.getCenterPoint().x,y2:r.getCenterPoint().y})})}),r.on("mousedblclick",function(e){var t=e.target,i=t.get("node"),r=n.nodes.filter(function(e){return e.parent===i});n.addTreeNode(t.getCenterPoint().x+20*r.length+1,t.getCenterPoint().y+80,i)}),this.canvas.add(r);var s={circle:r,line:o,parent:i};return s.circle.set("node",s),this.$store.commit("addNode",s),s},removeTreeNode:function(e){var t=this;e.parent&&(this.nodes.filter(function(t){return t.parent===e}).forEach(function(e){t.removeTreeNode(e)}),this.canvas.remove(e.circle),e.line&&this.canvas.remove(e.line),this.$store.commit("removeNode",e))}}},d=n("XyMi");var u=function(e){n("C07W")},h=Object(d.a)(l,function(){var e=this.$createElement;return(this._self._c||e)("canvas",{staticClass:"pad",attrs:{id:"pad"}})},[],!1,u,"data-v-1f0d426a",null).exports,f=n("mvHQ"),v=n.n(f),p={name:"TreeDisplay",computed:a()({parseJson:function(){var e=this.treeData;return"string"!=typeof e&&(e=v()(e,void 0,2)),(e=e.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g,function(e){var t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="'+t+'">'+e+"</span>"})}},Object(c.b)(["treeData"]))};var m=function(e){n("FlXh")},g={name:"App",components:{TreePad:h,TreeDisplay:Object(d.a)(p,function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("pre",{domProps:{innerHTML:this._s(this.parseJson)}})])},[],!1,m,null,null).exports},methods:{smoothTree:function(){console.log(123)}}};var b=function(e){n("0UbK")},C=Object(d.a)(g,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("div",{staticClass:"tree-pad"},[this._m(0),this._v(" "),t("div",{staticClass:"btn-panel"},[t("button",{on:{click:this.smoothTree}},[this._v("整理")])]),this._v(" "),t("tree-pad")],1),this._v(" "),t("div",{staticClass:"tree-json"},[t("tree-display")],1)])},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h2",[this._v("使用说明")]),this._v(" "),t("p",[this._v("1. 双击节点创建子节点")]),this._v(" "),t("p",[this._v("2. 选择节点后，按 Backspace/Delete 键删除节点（及其所有子节点）")])])}],!1,b,null,null).exports,N=n("Zrlr"),y=n.n(N),_=n("wxAW"),T=n.n(_),k=function(){function e(){y()(this,e),this.initID=0}return T()(e,[{key:"buildTreeJson",value:function(e){return this.initID=0,0===e.length?{}:this.generateNode(e[0],e)}},{key:"newNode",value:function(){return this.initID+=1,{id:this.initID,children:[]}}},{key:"generateNode",value:function(e,t){var n=this.newNode();return n.children=this.generateChildren(e,t),n}},{key:"generateChildren",value:function(e,t){var n=this,i=[];return t.filter(function(t){return t.parent===e}).forEach(function(e){i.push(n.generateNode(e,t))}),i}}]),e}();i.a.use(c.a);var P=new k,x=new c.a.Store({state:{nodes:[]},mutations:{addNode:function(e,t){e.nodes.push(t)},removeNode:function(e,t){var n=e.nodes.findIndex(function(e){return e===t});-1!==n&&e.nodes.splice(n,1)}},getters:{treeData:function(e){return P.buildTreeJson(e.nodes)}}});i.a.config.productionTip=!1,i.a.use(o.a),new i.a({el:"#app",components:{App:C},template:"<App/>",store:x})}},["NHnr"]);
//# sourceMappingURL=app.86ef02a8a6590d7e1252.js.map